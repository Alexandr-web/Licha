!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Sinera=e():t.Sinera=e()}(self,(()=>(()=>{"use strict";var t={d:(e,i)=>{for(var o in i)t.o(i,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:i[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Sinera:()=>T,Utils:()=>v});const i=(t,e,i)=>{const o=[];if(0===t&&1===Math.abs(e)){let s=0;for(let o=0;o<i;o++)s=(t*o+e*(i-o))/i;for(let i=t;i<=e;i+=s)o.push(i)}else{const s=(e-t)/(i-1);for(let i=t;i<=e;i+=s)o.push(Math.ceil(i))}return o},o=t=>"string"==typeof t,s=class{constructor(t,e,i,o,s=0,r=1){this.x=t,this.y=e,this.color=i,this.ctx=o,this.rotateDeg=s,this.opacity=r}setColor(t,e,s,r=0,n=0){Array.isArray(this.color)&&this.color.length>1?((t,e,o,s,r,n=0,a=0)=>{const l=r.createLinearGradient(n,e,a,o),h=i(0,1,t.length-1);t.map(((t,e)=>l.addColorStop(h[e],t))),r[s]=l})(this.color,t,e,s,this.ctx,r,n):Array.isArray(this.color)&&1===this.color.length?this.ctx[s]=this.color[0]:o(this.color)&&(this.ctx[s]=this.color)}},r=class extends s{constructor(t,e,i,o,s,r,n,a,l,h,c){super(t,e,i,o,l,h),this.width=s,this.height=r,this.startY=n,this.endY=a,this.stroke=c||{}}draw(){this.ctx.beginPath(),this.ctx.setLineDash([0,0]),this.ctx.globalAlpha=this.opacity,this.setColor(this.startY,this.endY,"fillStyle"),this.ctx.fillRect(this.x,this.y,this.width,this.height),Object.keys(this.stroke).length&&(this.ctx.lineWidth=this.stroke.width,this.ctx.strokeStyle=this.stroke.color,this.ctx.strokeRect(this.x,this.y,this.width,this.height))}},n=class extends s{constructor(t,e,i,o,s,r,n){super(i,o,s,e,r,n),this.font=t}getSizes(){this.ctx.font=this.font.str;const t=this.ctx.measureText(this.font.text);return{width:t.width,height:t.actualBoundingBoxAscent}}draw(){const{str:t,color:e,text:i}=this.font;this.ctx.save(),this.ctx.globalAlpha=this.opacity,this.ctx.font=t,this.ctx.fillStyle=e,0!==this.rotateDeg?(this.ctx.translate(this.x,this.y),this.ctx.rotate(this.rotateDeg),this.ctx.fillText(i,0,0)):this.ctx.fillText(i,this.x,this.y),this.ctx.restore()}},a=t=>"number"==typeof t&&!isNaN(t),l=(t,e)=>`${e} ${t}px Arial, sans-serif`,h=(t,e,i,o)=>new n({size:t,str:`${e} ${t}px Arial, sans-serif`,text:i},o).getSizes(),c=t=>({top:t,right:t,bottom:t,left:t}),g=class{constructor(t,e,i,o,s,r,n,l={},h=[]){this.hideGroups=h,this.theme=l,this.data=e,this.width=o,this.height=s,this.ctx=i,this.type=r,this.title=n||{},this.padding=a(t)?c(t):t,this.defaultPadding=10,this.titleData={font:{text:null,size:null,color:null,weight:null},gaps:{bottom:null},x:null,y:null,width:null,height:null}}getBounds(){const t=this.padding,e={width:null,height:null,horizontal:{start:a(t.left)?t.left:this.defaultPadding,end:this.width-(a(t.right)?t.right:this.defaultPadding)},vertical:{start:a(t.top)?t.top:this.defaultPadding,end:this.height-(a(t.bottom)?t.bottom:this.defaultPadding)}};return e.width=e.horizontal.end-e.horizontal.start,e.height=e.vertical.end-e.vertical.start,e}drawTitle(){if(!Object.keys(this.title).length)return this;const{weight:t=600,size:e,text:i,color:o=this.theme.color}=this.title.font,s={color:o,text:i,str:l(e,t)},r=h(e,t,i,this.ctx),a=this.getBounds(),c=a.horizontal.start,g={x:c+(a.horizontal.end-r.width-c)/2,y:a.vertical.start+r.height};return new n(s,this.ctx,g.x,g.y).draw(),this.titleData=Object.assign(Object.assign(Object.assign({},this.title),g),r),this}getGapsForYPoints(t,e,i,o){const{gaps:s={},totalHeight:r=0}=o,{showText:n=Boolean(Object.keys(e.font).length)}=e.font,a=(s.legend||{}).bottom||0,l=(t.titleData||{}).height||0,h=((t.titleData||{}).gaps||{}).right||0,c=(i||{}).height||0,g=((i||{}).gaps||{}).bottom||0,d=(e.titleData||{}).height||0,p=((e.titleData||{}).gaps||{}).top||0,u=e.rotate?e.getMaxWidthTextPoint():e.getMaxHeightTextPoint();return{left:l+h,top:c+g+r+a,bottom:(n?e.gapTopAxisX+u:0)+d+p}}getGapsForXPoints(t,e){const{font:i={},titleData:o={},gapRightAxisY:s}=t,{font:r={},titleData:n={}}=e,a=e.getIgnoreNames(),l=t.getAxesData(this.data).names,c=l[l.length-1],g=l[0],{weight:d=400,size:p,showText:u=Boolean(Object.keys(r).length)}=r,{showText:F=Boolean(Object.keys(i).length)}=i,x=h(p,d,e.getCorrectName(g).toString(),this.ctx).width,C=u&&!(a||[]).includes(g),b=h(p,d,e.getCorrectName(c).toString(),this.ctx).width,m=u&&!(a||[]).includes(c),w=o.height||0,D=(o.gaps||{}).right||0,f=n.height||0,B=(n.gaps||{}).top||0;return{left:(C?x/2:0)+w+D+(F?t.getMaxTextWidthAtYAxis()+s:0),right:m?b/2:0,bottom:f+B}}getGapsForLegend(t,e){const{height:i=0,gaps:o}=e,{bottom:s=0}=o,{font:r={}}=t.title||{},{size:n,weight:a=600,text:l}=r;return{top:i+s,left:h(n,a,l,this.ctx).height||0}}},d=function t(e,i){if(e.length<=1)return e;const o=e[e.length-1],s=[],r=[];for(let t=0;t<e.length-1;t++)(i?e[t][i]<o[i]:e[t]<o)?s.push(e[t]):r.push(e[t]);return[...t(s,i),o,...t(r,i)]},p=class{constructor(t,e,i,o={},s={},r={},n={}){this.ctx=t,this.title=r,this.font=n,this.bounds=i,this.points=[],this.sortNames=e||"less-more",this.uniqueNames=[],this.uniqueValues=[],this.gapTopAxisX=10,this.gapRightAxisY=10,this.themeForPoint=o,this.themeForTitle=s}getAxesData(t){const e=[],i=[];for(const o in t){const s=t[o].data;i.push(...s.map((({name:t})=>t))),e.push(...s.map((({value:t})=>t)))}const o=[...new Set(i)],s=[...new Set(e)],r=!o.some((t=>isNaN(+t))),n=d(s).reverse(),a=[];if(r)switch(this.sortNames){case"less-more":a.push(...d(o));break;case"more-less":a.push(...d(o).reverse())}return{values:n,names:r?a:o}}},u=t=>t instanceof Function,F=class extends p{constructor(t,e,i,o,s,r,n,a,l,h,c=3){super(i,n,s,l,a,o,r),this.step=c,this.editValue=t,this.data=e,this.sortValues=h||"less-more",this.titleData={x:null,y:null,width:null,height:null,font:{text:"",size:null,color:"",weight:null},gaps:{right:null}}}_getCorrectValue(t){return u(this.editValue)?this.editValue(t):t}drawTitle(){if(!Object.keys(this.title).length)return this;const t=this.bounds,{size:e,text:i,color:o=this.themeForTitle.color,weight:s=600}=this.title.font,r={size:e,text:i,color:o,str:l(e,s)},a=h(e,s,i,this.ctx),c=t.vertical.start+a.width,g=t.vertical.end,d={x:t.horizontal.start+a.height,y:c+(g-c)/2};return new n(r,this.ctx,d.x,d.y,null,Math.PI/180*-90).draw(),this.titleData=Object.assign(Object.assign(Object.assign({},this.title),a),d),this}_getPointsFromRange(t,e){const i=[];switch(this.sortValues){case"less-more":i.push(...e.reverse());break;case"more-less":i.push(...e)}return i.includes(t)||i.push(t),i}_fillDataPoints(t,e,i,o,s){t.map((t=>{const r=d(this.points,"value").find((({value:e})=>e>=t)),n=d(this.points,"value").reverse().find((({value:e})=>e<=t)),a=h(o,s,t.toString(),this.ctx),l={x:e?i.horizontal.start:0,y:n.y+(t-n.value)*((r.y-n.y)/(r.value-n.value||1))};this.points.find((({value:e})=>e===t))||this.points.push(Object.assign(Object.assign({value:t,onScreen:!1},l),a))}))}drawPoints(t){const e=this.getAxesData(this.data).values,o=this.bounds,{size:s,showText:r=Boolean(Object.keys(this.font).length),weight:a=400,color:c=this.themeForPoint.color}=this.font,g=Math.ceil(e[0]),d=Math.floor(e[e.length-1]),p=h(s,a,g.toString(),this.ctx),u=i(Math.min(g,d),Math.max(g,d),this.step),F=this._getPointsFromRange(d,u);return F.map(((e,i)=>{const g=h(s,a,this._getCorrectValue(e).toString(),this.ctx),d=o.vertical.start+p.height/2+(t.top||0),u=(o.vertical.end-d-(t.bottom||0))/(F.length-1),x={x:o.horizontal.start+(t.left||0),y:u*i+d},C=Object.assign(Object.assign({},this.font),{color:c,str:l(s,a),text:this._getCorrectValue(e).toString()});this.points.push(Object.assign(Object.assign({onScreen:!0,value:e},g),x)),r&&new n(C,this.ctx,x.x,x.y+g.height/2).draw()})),this._fillDataPoints(e,r,o,s,a),this}getMaxTextWidthAtYAxis(){return Math.max(...this.points.filter((({onScreen:t})=>t)).map((({width:t})=>t)))}},x=class extends s{constructor(t,e,i,o,s,r,n){super(t,e,i,o),this.lineTo=s,this.width=r||1,this.dotted=n}draw(){this.ctx.setLineDash(this.dotted?[10,20]:[0,0]),this.ctx.beginPath(),this.ctx.moveTo(this.x,this.y),this.ctx.globalAlpha=this.opacity,this.ctx.lineWidth=this.width,this.ctx.lineCap="round",this.lineTo.map((({x:t,y:e})=>{this.setColor(this.y,e,"strokeStyle",this.x,t),this.ctx.lineTo(t,e)})),this.ctx.stroke()}},C=class extends s{constructor(t,e,i,o,s,r,n,a,l){super(e,i,o,s,null,r),this.radius=t,this.stroke=l||{},this.startY=n,this.endY=a}draw(){this.ctx.beginPath(),this.ctx.setLineDash([0,0]),this.ctx.globalAlpha=this.opacity,this.setColor(this.startY,this.endY,"fillStyle"),this.ctx.arc(this.x,this.y,this.radius,2*Math.PI,0),this.ctx.fill(),Object.keys(this.stroke).length&&(this.ctx.lineWidth=this.stroke.width,this.ctx.strokeStyle=this.stroke.color,this.ctx.arc(this.x,this.y,this.radius,2*Math.PI,0),this.ctx.stroke())}},b=class extends s{constructor(t,e,i,o,s,r,n,a,l,h,c){super(e,i,o,r,h,n),this.format=s,this.size=t,this.stroke=c,this.startY=a,this.endY=l}draw(){switch(this.format){case"circle":new C(this.size,this.x,this.y,this.color,this.ctx,this.opacity,this.startY,this.endY,this.stroke).draw();break;case"square":new r(this.x,this.y,this.color,this.ctx,this.size,this.size,this.startY,this.endY,this.rotateDeg,this.opacity,this.stroke).draw()}}},m=class extends s{constructor(t,e,i,o,s,r,n,a){super(t,e,i,o,a),this.lineTo=s,this.startY=r,this.endY=n}draw(){this.ctx.beginPath(),this.ctx.moveTo(this.x,this.y),this.ctx.globalAlpha=this.opacity,this.ctx.lineCap="round",this.lineTo.map((({x:t,y:e})=>this.ctx.lineTo(t,e))),this.setColor(this.startY,this.endY,"fillStyle"),this.ctx.fill()}};function w(t,e,i){const o=t;if(o.length-1>=e)return o[e];for(let t=0;t<i.length&&!(o.length-1>=e);t++)o.push(i[t]);return w(o,e,i)}const D=(t,e=[])=>e.length?t>e.length-1?w([],t,e):e[t]||"":"",f=class extends g{constructor(t,e,i,o,s,r,n,a,l,h,c,g,d={},p={}){super(h,t,r,n,a,"line",l,null,c),this.pointsX=s,this.pointsY=o,this.line=e,this.cap=i,this.sortValues=g||"less-more",this.caps=[],this.themeForLine=d,this.themeForCaps=p}_getStyles(t,e,i){const o=Object.keys(this.data).indexOf(i),s=D(o,this.themeForLine.color),r=D(o,this.themeForLine.fill),n=D(o,this.themeForCaps.color),a=D(o,this.themeForCaps.strokeColor);return{lineStyle:{width:t.width||this.line.width,color:t.color||this.line.color||s,dotted:t.dotted||this.line.dotted,stepped:t.stepped||this.line.stepped,fill:t.fill||this.line.fill||r},capStyle:{size:e.size||this.cap.size,color:e.color||this.cap.color||n,stroke:e.stroke||this.cap.stroke||{},format:e.format||this.cap.format},themeStrokeColorForCap:a}}_getGroupsDataCoordinates(t){return t.map((({value:t,name:e})=>{const i=this.pointsY.find((e=>e.value===t)),o=this.pointsX.find((t=>t.name===e));return{x:o.x,y:i.y,value:i.value,name:o.name}}))}_getLineToForGroupFigure(t,e){const i=[];return t.map((({x:o,y:s},r)=>{if(e){const e=t[r+1];if(e){const t=this.pointsY.find((t=>t.value===e.value)),o=this.pointsX.find((t=>t.name===e.name));i.push({x:o.x,y:s},{x:o.x,y:t.y})}}else r>0&&i.push({x:o,y:s})})),i}_setFillGroupChart(t,e,i,o){const s=t[0],r=t[t.length-1],n=this.pointsY.filter((({onScreen:t})=>t)),a=n[n.length-1],l=n[0],h={moveTo:{x:s.x,y:s.y},lineTo:this._getLineToForGroupFigure(t,i),fill:e,group:o,startY:Math.min(...t.map((({y:t})=>t))),endY:a.y};switch(this.sortValues){case"less-more":h.lineTo.push({x:r.x,y:a.y},{x:s.x,y:a.y},h.moveTo);break;case"more-less":h.lineTo.push({x:r.x,y:l.y},{x:s.x,y:l.y},h.moveTo)}new m(h.moveTo.x,h.moveTo.y,h.fill,this.ctx,h.lineTo,h.startY,h.endY).draw()}_drawLine(t,e,i,o){new x(t,e,i.color,this.ctx,o,i.width,i.dotted).draw()}_drawCaps(t){this.caps.map((({x:e,y:i,color:o,format:s,size:r,stroke:n})=>{new b(r,e,i,o,s,this.ctx,1,"circle"===s?i-r:i-r/2,"circle"===s?i+r:i+r/2,0,{width:n.width||1,color:n.color||t}).draw()}))}_drawLinesAndCaps(t,e,i,o,s){const{lineStyle:r,capStyle:n,themeStrokeColorForCap:a}=this._getStyles(i,o,s),l=[];t.map((({value:t,name:i,x:o,y:a},h)=>{const c=e[h+1];if(c){const t=this.pointsY.find((t=>t.value===c.value)),e=this.pointsX.find((t=>t.name===c.name));r.stepped?l.push({x:e.x,y:a},{x:e.x,y:t.y}):l.push({x:e.x,y:t.y})}this.caps.push({group:s,value:t,name:i,x:"circle"===n.format?o:o-n.size/2,y:"circle"===n.format?a:a-n.size/2,stroke:n.stroke,format:n.format,size:n.size,color:n.color})})),this._drawLine(t[0].x,t[0].y,r,l),this._drawCaps(a)}draw(){const t=Object.keys(this.data).filter((t=>!this.hideGroups.includes(t))).reduce(((t,e)=>(t[e]=this.data[e],t)),{});for(const e in t){const{data:i,line:s={},cap:r={}}=t[e],{lineStyle:n}=this._getStyles(s,r,e),a=this._getGroupsDataCoordinates(i);(Array.isArray(n.fill)||o(n.fill)&&n.fill.length)&&this._setFillGroupChart(a,n.fill,n.stepped,e),this._drawLinesAndCaps(a,i,s,r,e)}return this}},B=class extends p{constructor(t,e,i,o,s,r,n,a,l,h,c,g,d={}){super(t,a,s,c,h,o,r),this.rotate=l,this.themeForLine=d,this.ignoreNames=g||[],this.data=e,this.editName=n,this.line=i,this.titleData={x:null,y:null,width:null,height:null,font:{text:"",size:null,color:"",weight:null},gaps:{top:null}}}getIgnoreNames(){return u(this.ignoreNames)?this.getAxesData(this.data).names.filter(this.ignoreNames):Array.isArray(this.ignoreNames)?this.ignoreNames:[]}drawTitle(){if(!Object.keys(this.title).length)return this;const{size:t,weight:e=600,color:i=this.themeForTitle.color,text:o}=this.title.font,s={size:t,color:i,text:o,weight:e,str:l(t,e)},r=this.bounds,a=h(t,e,o,this.ctx),c=r.horizontal.start,g={x:c+(r.horizontal.end-a.width-c)/2,y:r.vertical.end};return new n(s,this.ctx,g.x,g.y).draw(),this.titleData=Object.assign(Object.assign(Object.assign({},this.title),a),g),this}getCorrectName(t){return u(this.editName)?this.editName(t):t}_fillPointsData(t,e,i,o){for(const s in this.data){const r=this.data[s].data,n=Object.keys(this.data).indexOf(s),a=D(n,this.themeForLine.color);r.map((r=>{if(r.name===o){const n=this.data[s].line||{};this.points.push(Object.assign(Object.assign({onScreen:!t.includes(o),name:o,color:n.color||(this.line||{}).color||n.fill||(this.line||{}).fill||a,value:r.value,group:s},e),i))}}))}}_drawText(t,e,i,o,s,r,a,h){if(t&&!e.includes(r)){const t=Object.assign(Object.assign({},this.font),{color:i,str:l(o,s),text:this.getCorrectName(r).toString()});this.rotate?new n(t,this.ctx,a.x+h.height/2,a.y,null,Math.PI/180*-90).draw():new n(t,this.ctx,a.x-h.width/2,a.y).draw()}}drawPoints(t){const e=this.getAxesData(this.data).names,i=this.bounds,o=this.getIgnoreNames(),{size:s,weight:r=400,showText:n=Boolean(Object.keys(this.font).length),color:a=this.themeForPoint.color}=this.font;return e.map(((l,c)=>{const g=i.horizontal.start+(t.left||0),d=(i.horizontal.end-(t.right||0)-g)/(e.length-1),p=h(s,r,`${this.getCorrectName(l)}`,this.ctx),u={x:d*c+g,y:i.vertical.end-(t.bottom||0)};this._fillPointsData(o,u,p,l),this._drawText(n,o,a,s,r,l,u,p)})),this.font.showText=n,this}getMaxWidthTextPoint(){const t=this.getAxesData(this.data).names,{size:e,weight:i=400}=this.font,o=t.map((t=>h(e,i,`${this.getCorrectName(t)}`,this.ctx).width));return Math.max(...o)}getMaxHeightTextPoint(){const t=this.getAxesData(this.data).names,{size:e,weight:i=400}=this.font,o=t.map((t=>h(e,i,`${this.getCorrectName(t)}`,this.ctx).height));return Math.max(...o)}},A=class extends s{constructor(t,e,i,o,s,r,n,l,h,g,d,p=10,u={},F={},x={},C={}){super(l,h,g,d),this.editValue=t,this.editName=e,this.data=i,this.bounds=o,this.elements=s,this.padding=a(p)?c(p):p,this.titleData=r,this.groupsData=n,this.groupLineWidth=5,this.triangleSizes={height:10,width:15},this.title=s[0].name,this.themeForWindow=u,this.themeForLine=F,this.themeForTitle=x,this.themeForGroup=C,this.defaultTitleFontWeight=600,this.defaultGroupsFontWeight=400}_getCorrectGroupValue(t){return u(this.editValue)?this.editValue(t):t}_getElementsWithSize(){return this.elements.map((({group:t,value:e,color:i})=>{const o=this._getCorrectGroupValue(e),s=`${t}: ${o}`,{font:r}=this.groupsData,{font:n}=this.titleData;return{group:Object.assign({name:s,color:i},h(r.size,r.weight||this.defaultTitleFontWeight,s,this.ctx)),value:Object.assign({name:o.toString()},h(n.size,n.weight||this.defaultGroupsFontWeight,o.toString(),this.ctx))}}))}_getCoordinates(){return{x:this.x+this.triangleSizes.height,y:this.y}}_getTopGroupsDistance(t){const{gaps:e}=this.groupsData;return t.reduce(((t,{height:i})=>t+(i+e.bottom)),0)}_getNewLinesPosIfWindowIsOutOfBounds(t,e,i,o){return{moveTo:{x:t-(e+2*this.triangleSizes.height),y:i.y-o.height},lineTo:[{x:t-(e+2*this.triangleSizes.height),y:i.y}]}}_drawLines(t,e){const i=this.padding,{x:o}=this._getCoordinates();for(let s=0;s<this.elements.length;s++){const{group:r}=this._getElementsWithSize()[s],n=this._getGroupsCoordinates(s),a=o+e-(i.right||0);let l={moveTo:{x:a,y:n.y-r.height},lineTo:[{x:a,y:n.y}]};t&&(l=this._getNewLinesPosIfWindowIsOutOfBounds(a,e,n,r)),new x(l.moveTo.x,l.moveTo.y,r.color,this.ctx,l.lineTo,this.groupLineWidth).draw()}}_getTitleSize(){const{font:t}=this.titleData,{size:e,weight:i=this.defaultTitleFontWeight}=t;return h(e,i,this.title.toString(),this.ctx)}_drawTitle(t,e){const i=this.padding,{x:o,y:s}=this._getCoordinates(),r={x:o+(i.left||0),y:s+(i.top||0)+this._getTitleSize().height};t&&(r.x-=e+2*this.triangleSizes.height);const{font:a}=this.titleData,{size:h,color:c=this.themeForTitle.color,weight:g=this.defaultTitleFontWeight}=a,d={color:c,text:this.title.toString(),str:l(h,g)};new n(d,this.ctx,r.x,r.y).draw()}_getGroupsCoordinates(t){const{x:e,y:i}=this._getCoordinates(),{gaps:o={}}=this.titleData,s=this.padding,r=this._getElementsWithSize().filter(((e,i)=>i<=t)),n=this._getTopGroupsDistance(r.map((({group:t})=>t)));return{x:e+(s.left||0),y:i+n+this._getTitleSize().height+(o.bottom||0)}}_drawGroups(t,e){const{font:i}=this.groupsData,{size:o,weight:s=this.defaultGroupsFontWeight,color:r=this.themeForGroup.color}=i;this._getElementsWithSize().map((({group:i},a)=>{const h={text:i.name,color:r,str:l(o,s)},c=this._getGroupsCoordinates(a);t&&(c.x-=e+2*this.triangleSizes.height),new n(h,this.ctx,c.x,c.y).draw()}))}_getMaxContentWidth(t){const e=d(t.map((({group:t})=>t)),"width").reverse()[0].width,i=this._getTitleSize().width;return Math.max(e,i)}_outOfBounds(t){return this._getCoordinates().x+t>this.bounds.width}_getWindowSize(){const t=this.padding,{gaps:e}=this.groupsData,{gaps:i}=this.titleData,o=this._getElementsWithSize().map((({group:t})=>t));return{width:this._getMaxContentWidth(this._getElementsWithSize())+(t.right||0)+(t.left||0)+(e.right||0)+this.groupLineWidth,height:this._getTitleSize().height+this._getTopGroupsDistance(o)+(i.bottom||0)+(t.bottom||0)}}_getNewPosTriangleIfWindowIsOutOfBounds(t,e){return{x:t-this.triangleSizes.height,y:e,lineTo:[{x:t,y:e+this.triangleSizes.width/2},{x:t-this.triangleSizes.height,y:e+this.triangleSizes.width}]}}_drawTriangle(t){const e=this.x,i=this.y,o={x:e+this.triangleSizes.height,y:i,lineTo:[{x:e,y:i+this.triangleSizes.width/2},{x:e+this.triangleSizes.height,y:i+this.triangleSizes.width}],startY:i,endY:i+this.triangleSizes.width};if(t){const{x:t,y:s,lineTo:r}=this._getNewPosTriangleIfWindowIsOutOfBounds(e,i);Object.assign(o,{x:t,y:s,lineTo:r})}new m(o.x,o.y,this.color||this.themeForWindow.color,this.ctx,o.lineTo,o.startY,o.endY).draw()}_drawWindow(t,e,i){const o=this._getCoordinates();t&&(o.x-=e+2*this.triangleSizes.height),new r(o.x,o.y,this.color||this.themeForWindow.color,this.ctx,e,i,o.y,o.y+i).draw()}init(){const t=this._outOfBounds(this._getWindowSize().width),{width:e,height:i}=this._getWindowSize();this._drawTriangle(t),this._drawWindow(t,e,i),this._drawTitle(t,e),this._drawGroups(t,e),this._drawLines(t,e)}},E=[{canvas:{background:"#FFFFFF"},title:{color:"#2E2F35"},legend:{color:"#484A53"},axis:{title:{color:"#2E2F35"},point:{color:"#484A53"}},grid:{color:"#EDEDEC"},line:{color:["rgba(178,207,231,0.9)","rgba(178,83,231,0.9)","rgba(93,53,231,0.9)","rgba(80,200,120,0.9)"],fill:[["rgba(178,207,231,0.3)","transparent"],["rgba(178,83,231,0.3)","transparent"],["rgba(93,53,231,0.3)","transparent"],["rgba(80,200,120,0.3)","transparent"]]},cap:{color:["#2A5DA1","#B253E7","#5D35E7","#50C878"],strokeColor:["rgba(178,207,231,0.9)","rgba(178,83,231,0.9)","rgba(93,53,231,0.9)","rgba(80,200,120,0.9)"]},blockInfo:{window:{color:"#101728"},title:{color:"#C2C7D5"},group:{color:"#BBBFCD"}}},{canvas:{background:"#FFFFFF"},title:{color:"#2E2F35"},legend:{color:"#484A53"},axis:{title:{color:"#2E2F35"},point:{color:"#484A53"}},grid:{color:"#EAEAEA"},line:{color:["#82C970","#A5FF8E","#00FF0C","#00800C"],fill:[["rgba(130,201,112,0.3)","transparent"],["rgba(165,255,142,0.3)","transparent"],["rgba(0,255,12,0.3)","transparent"],["rgba(0,128,12,0.3)","transparent"]]},cap:{color:["#82C970","#A5FF8E","#00FF0C","#00800C"],strokeColor:["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]},blockInfo:{window:{color:"#000000"},title:{color:"#FDFDFD"},group:{color:"#D3D3D3"}}},{canvas:{background:"#F4F5F7"},title:{color:"#2E2F35"},legend:{color:"#484A53"},axis:{title:{color:"#2E2F35"},point:{color:"#484A53"}},grid:{color:"#D2D3D5"},line:{color:["#E49BF7","#4B4F9A","#69D8F4","#F9C366"],fill:[["rgba(228,155,247,0.3)","transparent"],["rgba(75,79,154,0.3)","transparent"],["rgba(105,216,244,0.3)","transparent"],["rgba(249,195,102,0.3)","transparent"]]},cap:{color:["#F4F5F7","#F4F5F7","#F4F5F7","#F4F5F7"],strokeColor:["#E49BF7","#4B4F9A","#69D8F4","#F9C366"]},blockInfo:{window:{color:"#000000"},title:{color:"#FDFDFD"},group:{color:"#D3D3D3"}}},{canvas:{background:"#FFFFFF"},title:{color:"#2E2F35"},legend:{color:"#484A53"},axis:{title:{color:"#2E2F35"},point:{color:"#484A53"}},grid:{color:"#D2D3D5"},line:{color:["#F44133","#9370EE","#39DBFF","#3E51EB"],fill:[["rgba(244,65,51,0.3)","transparent"],["rgba(147,112,238,0.3)","transparent"],["rgba(57,219,255,0.3)","transparent"],["rgba(62,81,235,0.3)","transparent"]]},cap:{color:["#F44133","#9370EE","#39DBFF","#3E51EB"],strokeColor:[]},blockInfo:{window:{color:"#383838"},title:{color:"#FDFDFD"},group:{color:"#D3D3D3"}}},{canvas:{background:"#FEFEFE"},title:{color:"#2E2F35"},legend:{color:"#484A53"},axis:{title:{color:"#2E2F35"},point:{color:"#484A53"}},grid:{color:"#D0D0D0"},line:{color:["rgba(0,156,228,0.7)","rgba(224,1,53,0.9)","rgba(21,212,0,0.9)"],fill:[["rgba(0,156,228,0.3)","transparent"],["rgba(224,1,53,0.3)","transparent"],["rgba(21,212,0,0.3)","transparent"]]},blockInfo:{window:{color:"#E7E7E7"},title:{color:"#2E2F35"},group:{color:"#484A53"}}}],y=[{canvas:{background:"#10143A"},title:{color:"#EBEDFA"},legend:{color:"#9CA1BC"},axis:{title:{color:"#EBEDFA"},point:{color:"#9CA1BC"}},grid:{color:"#070818"},line:{color:["#4C359F","#6285C1","#D37DE7","#318CE7","#50C878"],fill:[["rgba(76,53,159,0.3)","transparent"],["rgba(98,133,193,0.3)","transparent"],["rgba(211,125,231,0.3)","transparent"],["rgba(49,140,231,0.3)","transparent"],["rgba(80,200,120,0.3)","transparent"]]},cap:{color:["#4C359F","#6285C1","#D37DE7","#318CE7","#50C878"],strokeColor:["#10143A","#10143A","#10143A","#10143A","#10143A"]},blockInfo:{window:{color:["#292F4F","#262C50"]},title:{color:"#EBEDFA"},group:{color:"#9CA1BC"}}},{canvas:{background:"#1B1B1B"},title:{color:"#E9E9E9"},legend:{color:"#878A94"},axis:{title:{color:"#E9E9E9"},point:{color:"#878A94"}},grid:{color:"#272727"},line:{color:["#53CA6B","#A93E62","#3344B1","#774CAF"],fill:[["rgba(80,200,120,0.3)","transparent"],["rgba(169,62,98,0.3)","transparent"],["rgba(51,68,177,0.3)","transparent"],["rgba(119,76,175,0.3)","transparent"]]},cap:{color:["#53CA6B","#A93E62","#3344B1","#774CAF"],strokeColor:["#1B1B1B","#1B1B1B","#1B1B1B","#1B1B1B"]},blockInfo:{window:{color:"#070707"},title:{color:"#E9E9E9"},group:{color:"#878A94"}}},{canvas:{background:"#262628"},title:{color:"#FDFDFE"},legend:{color:"#46454B"},axis:{title:{color:"#FDFDFE"},point:{color:"#46454B"}},grid:{color:"#2D2D2D"},line:{color:["#A05663","#608C7B","#488ED5","#D5590D"],fill:[["rgba(160,86,99,0.3)","transparent"],["rgba(96,140,123,0.3)","transparent"],["rgba(72,142,213,0.3)","transparent"],["rgba(213,89,13,0.3)","transparent"]]},cap:{color:["#A05663","#608C7B","#488ED5","#D5590D"],strokeColor:["#262628","#262628","#262628","#262628"]},blockInfo:{window:{color:"#1C1C1E"},title:{color:"#FDFDFE"},group:{color:"#46454B"}}},{canvas:{background:"#212121"},title:{color:"#E5E5E5"},legend:{color:"#696969"},axis:{title:{color:"#E5E5E5"},point:{color:"#696969"}},grid:{color:"#3B3B3B"},line:{color:["#CDE382","#DF5844","#546559","#6D639D"],fill:[["rgba(205,227,130,0.2)","transparent"],["rgba(223,88,68,0.2)","transparent"],["rgba(84,101,89,0.2)","transparent"],["rgba(109,99,157,0.2)","transparent"]]},cap:{color:["#CDE382","#DF5844","#546559","#6D639D"],strokeColor:["#212121","#212121","#212121","#212121"]},blockInfo:{window:{color:"#000000"},title:{color:"#E5E5E5"},group:{color:"#696969"}}},{canvas:{background:"#160D23"},title:{color:"#EDEAEF"},legend:{color:"#4B4162"},axis:{title:{color:"#EDEAEF"},point:{color:"#4B4162"}},grid:{color:"#211732"},line:{color:["#6EFBDD","#F84E82","#5F4591","#71FB88","#FBE471"],fill:[["rgba(67,50,102,0.5)","transparent"],["rgba(248,78,130,0.3)","transparent"],["rgba(95,69,145,0.3)","transparent"],["rgba(113,251,136,0.3)","transparent"],["rgba(251,228,113,0.3)","transparent"]]},cap:{color:["#6EFBDD","#F84E82","#5F4591","#71FB88","#FBE471"],strokeColor:[]},blockInfo:{window:{color:"#000000"},title:{color:"#EDEAEF"},group:{color:"#4B4162"}}},{canvas:{background:"#371F67"},title:{color:"#DAC6FF"},legend:{color:"#836FAB"},axis:{title:{color:"#DAC6FF"},point:{color:"#836FAB"}},grid:{color:"#4B316B"},line:{color:["#9F3F7D","#6FA1CD","#E7877B","#F6488A"],fill:[["rgba(159,63,125,0.5)","transparent"],["rgba(111,161,205,0.5)","transparent"],["rgba(231,135,123,0.5)","transparent"],["rgba(246,72,138,0.5)","transparent"]]},cap:{color:["#9F3F7D","#6FA1CD","#E7877B","#F6488A"],strokeColor:["#371F67","#371F67","#371F67","#371F67"]},blockInfo:{window:{color:"#DAC6FF"},title:{color:"#4B316B"},group:{color:"#836FAB"}}},{canvas:{background:"#2A2C3B"},title:{color:"#CCCCD8"},legend:{color:"#7C7E83"},axis:{title:{color:"#CCCCD8"},point:{color:"#7C7E83"}},grid:{color:"#3E4156"},line:{color:["#369F8F","#2D6685","#E48667","#B25E8C","#E3E77B"],fill:[["rgba(54,159,143,0.3)","transparent"],["rgba(45,102,133,0.3)","transparent"],["rgba(228,134,103,0.3)","transparent"],["rgba(178,94,140,0.3)","transparent"],["rgba(227,231,123,0.3)","transparent"]]},cap:{color:["#369F8F","#2D6685","#E48667","#B25E8C","#E3E77B"],strokeColor:["#2A2C3B","#2A2C3B","#2A2C3B","#2A2C3B","#2A2C3B"]},blockInfo:{window:{color:"#29384B"},title:{color:"#CCCCD8"},group:{color:"#7C7E83"}}},{canvas:{background:"#22252A"},title:{color:"#88AFB4"},legend:{color:"#317375"},axis:{title:{color:"#88AFB4"},point:{color:"#317375"}},grid:{color:"#33373E"},line:{color:["#11B8BF","#2C5A61","#99FFFF"],fill:[["rgba(17,184,191,0.3)","transparent"],["rgba(44,90,97,0.3)","transparent"],["rgba(153,255,255,0.3)","transparent"]]},cap:{color:["#11B8BF","#2C5A61","#99FFFF"],strokeColor:[]},blockInfo:{window:{color:"#121418"},title:{color:"#88AFB4"},group:{color:"#317375"}}},{canvas:{background:"#2F3245"},title:{color:"#D7D9E8"},legend:{color:"#828598"},axis:{title:{color:"#D7D9E8"},point:{color:"#828598"}},grid:{color:"#373B4C"},line:{color:["#D4D68A","#60AFA6","#5A7DCF","#D580E7"],fill:[["rgba(212,214,138,0.3)","transparent"],["rgba(96,175,166,0.3)","transparent"],["rgba(90,125,207,0.3)","transparent"],["rgba(213,128,231,0.3)","transparent"]]},cap:{color:["#D4D68A","#60AFA6","#5A7DCF","#D580E7"],strokeColor:["#2F3245","#2F3245","#2F3245","#2F3245"]},blockInfo:{window:{color:"#262938"},title:{color:"#D7D9E8"},group:{color:"#828598"}}},{canvas:{background:"#3C4256"},title:{color:"#FFF4F7"},legend:{color:"#B3B7BE"},axis:{title:{color:"#FFF4F7"},point:{color:"#B3B7BE"}},grid:{color:"#4C5061"},line:{color:["#FCFFFF","#85EDFF","#FC8EFF"],fill:[["rgba(252,255,255,0.3)","transparent"],["rgba(133,237,255,0.3)","transparent"],["rgba(252,142,255,0.3)","transparent"]]},cap:{color:["#B3B7BE","#A6F2FF","#FDBBFF"],strokeColor:["#FCFFFF","#85EDFF","#FC8EFF"]},blockInfo:{window:{color:"#2D303E"},title:{color:"#FFF4F7"},group:{color:"#B3B7BE"}}},{canvas:{background:"#3D404F"},title:{color:"#E1E1F0"},legend:{color:"#C8C8D5"},axis:{title:{color:"#E1E1F0"},point:{color:"#C8C8D5"}},grid:{color:"#484B5A"},line:{color:["#6CB1F8","#F7D076","#E9945A","#CFD4DA"]},cap:{color:["#6CB1F8","#F7D076","#E9945A","#CFD4DA"]},blockInfo:{window:{color:"#2D303E"},title:{color:"#E1E1F0"},group:{color:"#C8C8D5"}}},{canvas:{background:"#1F212E"},title:{color:"#C6CFE4"},legend:{color:"#747985"},axis:{title:{color:"#C6CFE4"},point:{color:"#747985"}},grid:{color:"#2D2F3C"},line:{color:["#D188F5","#3E99E8","#9244E9","#EDDFF6"],fill:[["rgba(229,181,239,0.3)","transparent"],["rgba(77,132,236,0.3)","transparent"],["rgba(146,68,233,0.3)","transparent"],["rgba(237,223,246,0.3)","transparent"]]},cap:{color:["#D188F5","#3E99E8","#9244E9","#EDDFF6"],strokeColor:["#1F212E","#1F212E","#1F212E","#1F212E"]},blockInfo:{window:{color:"#0F111E"},title:{color:"#C6CFE4"},group:{color:"#747985"}}},{canvas:{background:"#171717"},title:{color:"#D9D9D9"},legend:{color:"#BBBBBB"},axis:{title:{color:"#D9D9D9"},point:{color:"#BBBBBB"}},grid:{color:"#2C2C2C"},line:{color:["#C46BD1","#8157E3","#74E8BD","#FCB72A"],fill:[["rgba(196,107,209,0.3)","transparent"],["rgba(129,87,227,0.3)","transparent"],["rgba(116,232,189,0.3)","transparent"],["rgba(252,183,42,0.3)","transparent"]]},cap:{color:["#C46BD1","#8157E3","#74E8BD","#FCB72A"],strokeColor:["#171717","#171717","#171717","#171717"]},blockInfo:{window:{color:"#000000"},title:{color:"#D9D9D9"},group:{color:"#BBBBBB"}}},{canvas:{background:"#2A2430"},title:{color:"#C8C0D0"},legend:{color:"#938D99"},axis:{title:{color:"#C8C0D0"},point:{color:"#938D99"}},grid:{color:"#38323E"},line:{color:["#0FE5F3","#138CED","#E548E3","#5A4DD3","#4DD35A"],fill:[["rgba(15,229,243,0.3)","transparent"],["rgba(19,140,237,0.3)","transparent"],["rgba(229,72,227,0.3)","transparent"],["rgba(90,77,211,0.3)","transparent"],["rgba(77,211,90,0.3)","transparent"]]},cap:{color:["#0FE5F3","#138CED","#E548E3","#5A4DD3","#4DD35A"],strokeColor:["#2A2430","#2A2430","#2A2430","#2A2430","#2A2430"]},blockInfo:{window:{color:"#100D12"},title:{color:"#C8C0D0"},group:{color:"#938D99"}}},{canvas:{background:"#383B4A"},title:{color:"#DBD9E6"},legend:{color:"#C3C2CD"},axis:{title:{color:"#DBD9E6"},point:{color:"#C3C2CD"}},grid:{color:"#5C6177"},line:{color:["#52CFE7","#1E77E0","#EA9F41","#0A8792","#94398C"],fill:[["rgba(82,207,231,0.3)","transparent"],["rgba(30,119,224,0.3)","transparent"],["rgba(234,159,65,0.3)","transparent"],["rgba(10,135,146,0.3)","transparent"],["rgba(148,57,140,0.3)","transparent"]]},cap:{color:["#52CFE7","#1E77E0","#EA9F41","#0A8792","#94398C"],strokeColor:["#383B4A","#383B4A","#383B4A","#383B4A","#383B4A"]},blockInfo:{window:{color:"#343746"},title:{color:"#DBD9E6"},group:{color:"#C3C2CD"}}},{canvas:{background:"#130F14"},title:{color:"#ADADB2"},legend:{color:"#8A8A8E"},axis:{title:{color:"#ADADB2"},point:{color:"#8A8A8E"}},grid:{color:"#2C2E38"},line:{color:["#A62D33","#56A249","#DBBD55","#0A8792","#863CB0"],fill:[["rgba(166,45,51,0.3)","transparent"],["rgba(86,162,73,0.3)","transparent"],["rgba(234,159,65,0.3)","transparent"],["rgba(10,135,146,0.3)","transparent"],["rgba(134,60,176,0.3)","transparent"]]},cap:{color:["#A62D33","#56A249","#DBBD55","#0A8792","#863CB0"],strokeColor:["#130F14","#130F14","#130F14","#130F14","#130F14"]},blockInfo:{window:{color:"#050506"},title:{color:"#ADADB2"},group:{color:"#8A8A8E"}}},{canvas:{background:"#212338"},title:{color:"#97B7BF"},legend:{color:"#7F99A0"},axis:{title:{color:"#97B7BF"},point:{color:"#7F99A0"}},grid:{color:"#40435C"},line:{color:["#FB6F74","#F2A652","#CB4C8C","#17C5CB","#25F6B4"],fill:[["rgba(251,111,116,0.3)","transparent"],["rgba(242,166,82,0.3)","transparent"],["rgba(203,76,140,0.3)","transparent"],["rgba(23,197,203,0.3)","transparent"],["rgba(37,246,180,0.3)","transparent"]]},cap:{color:["#FB6F74","#F2A652","#CB4C8C","#17C5CB","#25F6B4"],strokeColor:["#212338","#212338","#212338","#212338","#212338"]},blockInfo:{window:{color:"#171827"},title:{color:"#97B7BF"},group:{color:"#7F99A0"}}},{canvas:{background:"#0E0A01"},title:{color:"#C4B5D0"},legend:{color:"#9F93A9"},axis:{title:{color:"#C4B5D0"},point:{color:"#9F93A9"}},grid:{color:"#1B100D"},line:{color:["#7C51AB","#AAA8A9","#C89DFA"],fill:[["rgba(124,81,171,0.3)","transparent"],["rgba(170,168,169,0.3)","transparent"],["rgba(200,157,250,0.3)","transparent"]]},cap:{color:["#7C51AB","#AAA8A9","#C89DFA"],strokeColor:["#0E0A01","#0E0A01","#0E0A01"]},blockInfo:{window:{color:"#000000"},title:{color:"#C4B5D0"},group:{color:"#9F93A9"}}},{canvas:{background:"#000000"},title:{color:"#C5C5C5"},legend:{color:"#ACACAC"},axis:{title:{color:"#C5C5C5"},point:{color:"#ACACAC"}},grid:{color:"#1E1E1E"},line:{color:["#FC1819","#FFF2F0","#333532","#C0BFC0","#99342F"],fill:[["rgba(252,24,25,0.3)","transparent"],["rgba(255,242,240,0.3)","transparent"],["rgba(51,53,50,0.3)","transparent"],["rgba(192,191,192,0.3)","transparent"],["rgba(153,52,47,0.3)","transparent"]]},cap:{color:["#FC1819","#FFF2F0","#333532","#C0BFC0","#99342F"],strokeColor:["#000000","#000000","#000000","#000000","#000000"]},blockInfo:{window:{color:"#1E1E1E"},title:{color:"#C5C5C5"},group:{color:"#ACACAC"}}},{canvas:{background:"#193565"},title:{color:"#E7EDFF"},legend:{color:"#CCD1E1"},axis:{title:{color:"#E7EDFF"},point:{color:"#CCD1E1"}},grid:{color:"#102241"},line:{color:["#9E51D0","#6485E2","#01A8D0","#0154CE"],fill:[["rgba(158,81,208,0.3)","transparent"],["rgba(100,133,226,0.3)","transparent"],["rgba(1,168,208,0.3)","transparent"],["rgba(1,84,206,0.3)","transparent"]]},cap:{color:["#9E51D0","#6485E2","#01A8D0","#0154CE"],strokeColor:["#193565","#193565","#193565","#193565"]},blockInfo:{window:{color:["#0A1427","#152D56"]},title:{color:"#E7EDFF"},group:{color:"#CCD1E1"}}},{canvas:{background:"#211E3D"},title:{color:"#FDFEF8"},legend:{color:"#D5D6D1"},axis:{title:{color:"#FDFEF8"},point:{color:"#D5D6D1"}},grid:{color:"#373356"},line:{color:["#F326A3","#9153F4","#F2A543","#FFFCFF"],fill:[["rgba(243,38,163,0.3)","transparent"],["rgba(145,83,244,0.3)","transparent"],["rgba(242,165,67,0.3)","transparent"],["rgba(255,252,255,0.3)","transparent"]]},cap:{color:["#F326A3","#9153F4","#F2A543","#FFFCFF"],strokeColor:["#211E3D","#211E3D","#211E3D","#211E3D"]},blockInfo:{window:{color:["#121021","#151327"]},title:{color:"#FDFEF8"},group:{color:"#D5D6D1"}}},{canvas:{background:"#09284B"},title:{color:"#F4F8FD"},legend:{color:"#C3C6CA"},axis:{title:{color:"#F4F8FD"},point:{color:"#C3C6CA"}},grid:{color:"#0B3F74"},line:{color:["#FB917E","#14C0D3","#7659E5","#C64264","#148B73"],fill:[["rgba(251,145,126,0.3)","transparent"],["rgba(20,192,211,0.3)","transparent"],["rgba(118,89,229,0.3)","transparent"],["rgba(198,66,100,0.3)","transparent"],["rgba(20,139,115,0.3)","transparent"]]},cap:{color:["#FB917E","#14C0D3","#7659E5","#C64264","#148B73"],strokeColor:["#09284B","#09284B","#09284B","#09284B","#09284B"]},blockInfo:{window:{color:"#030F1B"},title:{color:"#F4F8FD"},group:{color:"#C3C6CA"}}},{canvas:{background:"#474A5B"},title:{color:"#CADBFF"},legend:{color:"#94A0BB"},axis:{title:{color:"#CADBFF"},point:{color:"#94A0BB"}},grid:{color:"#777B8E"},line:{color:["#1A78F5","#74C278","#CD4560","#C5F664","#36DED3"],fill:[["rgba(26,120,245,0.3)","transparent"],["rgba(116,194,120,0.3)","transparent"],["rgba(205,69,96,0.3)","transparent"],["rgba(197,246,100,0.3)","transparent"],["rgba(54,222,211,0.3)","transparent"]]},cap:{color:["#474A5B","#474A5B","#474A5B","#474A5B","#474A5B"],strokeColor:["#1A78F5","#74C278","#CD4560","#C5F664","#36DED3"]},blockInfo:{window:{color:"#292B35"},title:{color:"#CADBFF"},group:{color:"#94A0BB"}}},{canvas:{background:"#201F25"},title:{color:"#F8F9F8"},legend:{color:"#CFD0CF"},axis:{title:{color:"#F8F9F8"},point:{color:"#CFD0CF"}},grid:{color:"#36393E"},line:{color:["#C75770","#C7002B","#FF0037","#710037"],fill:[["rgba(199,87,112,0.3)","transparent"],["rgba(199,0,43,0.3)","transparent"],["rgba(255,0,55,0.3)","transparent"],["rgba(113,0,55,0.3)","transparent"]]},cap:{color:["#201F25","#201F25","#201F25","#201F25"],strokeColor:["#C75770","#C7002B","#FF0037","#710037"]},blockInfo:{window:{color:"#080809"},title:{color:"#F8F9F8"},group:{color:"#CFD0CF"}}},{canvas:{background:"#36446B"},title:{color:"#F1F4F8"},legend:{color:"#C7CACD"},axis:{title:{color:"#F1F4F8"},point:{color:"#C7CACD"}},grid:{color:"#4E629A"},line:{color:["#358CBE","#35B59D","#5462DD","#8862DD"],fill:[["rgba(53,140,190,0.3)","transparent"],["rgba(53,181,157,0.3)","transparent"],["rgba(84,98,221,0.3)","transparent"],["rgba(136,98,221,0.3)","transparent"]]},cap:{color:["#36446B","#36446B","#36446B","#36446B"],strokeColor:["#358CBE","#35B59D","#5462DD","#8862DD"]},blockInfo:{window:{color:"#1D2438"},title:{color:"#F1F4F8"},group:{color:"#C7CACD"}}}],k=(t,e=1)=>`rgba(${t},${e})`,_={white:t=>k("255,255,255",t),whiteSmoke:t=>k("245,245,245",t),antiFlashWhite:t=>k("235,235,235",t),platinum:t=>k("224,224,224",t),timberwolf:t=>k("214,214,214",t),silver:t=>k("204,204,204",t),bistre:t=>k("204,204,204",t),black:t=>k("0,0,0",t),blackBean:t=>k("61,12,2",t),blackOlive:t=>k("59,60,54",t),cafeNoir:t=>k("75,54,33",t),charcoal:t=>k("54,69,79",t),darkPurple:t=>k("48,25,52",t),ebony:t=>k("85,93,80",t),eclipse:t=>k("0,0,32",t),eerieBlack:t=>k("27,27,27",t),jet:t=>k("52,52,52",t),licorice:t=>k("26,17,16",t),midnight:t=>k("0,0,64",t),night:t=>k("17,17,17",t),onyx:t=>k("53,56,57",t),outerSpace:t=>k("65,74,76",t),raisinBlack:t=>k("36,33,36",t),richBlack:t=>k("1,11,19",t),russianViolet:t=>k("50,23,77",t),smokyBlack:t=>k("16,12,8",t),taupe:t=>k("72,60,50",t),indianRed:t=>k("205,92,92",t),lightCoral:t=>k("240,128,128",t),salmon:t=>k("250,128,114",t),darkSalmon:t=>k("233,150,122",t),lightSalmon:t=>k("255,160,122",t),crimson:t=>k("220,20,60",t),red:t=>k("255,0,0",t),fireBrick:t=>k("178,34,3",t),darkRed:t=>k("139,0,0",t),pink:t=>k("255,192,203",t),lightPink:t=>k("255,182,193",t),hotPink:t=>k("255,105,180",t),deepPink:t=>k("255,20,147",t),mediumVioletRed:t=>k("199,21,133",t),paleVioletRed:t=>k("219,112,147",t),coral:t=>k("255,127,8",t),tomato:t=>k("255,99,7",t),orangeRed:t=>k("255,69,0",t),darkOrange:t=>k("255,140,0",t),orange:t=>k("255,165,0",t),gold:t=>k("255,215,0",t),yellow:t=>k("255,255,0",t),lightYellow:t=>k("255,255,224",t),lemonChiffon:t=>k("255,250,205",t),lightGoldenrodYellow:t=>k("250,250,210",t),papayaWhip:t=>k("255,239,213",t),moccasin:t=>k("255,228,181",t),peachPuff:t=>k("255,218,185",t),paleGoldenrod:t=>k("238,232,170",t),khaki:t=>k("240,230,140",t),darkKhaki:t=>k("189,183,107",t),lavender:t=>k("230,230,250",t),thistle:t=>k("216,191,216",t),plum:t=>k("221,160,221",t),violet:t=>k("238,130,238",t),orchid:t=>k("218,112,214",t),fuchsia:t=>k("255,0,255",t),magenta:t=>k("255,0,255",t),mediumOrchid:t=>k("186,85,211",t),mediumPurple:t=>k("147,112,219",t),rebeccaPurple:t=>k("102,51,153",t),blueViolet:t=>k("138,43,226",t),darkViolet:t=>k("148,0,211",t),darkOrchid:t=>k("153,50,204",t),darkMagenta:t=>k("139,0,139",t),purple:t=>k("128,0,128",t),indigo:t=>k("75,0,130",t),slateBlue:t=>k("106,90,205",t),darkSlateBlue:t=>k("72,61,139",t),mediumSlateBlue:t=>k("123,104,238",t),greenYellow:t=>k("173,255,47",t),chartreuse:t=>k("127,255,0",t),lawnGreen:t=>k("124,252,0",t),lime:t=>k("0,255,0",t),limeGreen:t=>k("50,205,50",t),paleGreen:t=>k("152,251,152",t),lightGreen:t=>k("144,238,144",t),mediumSpringGreen:t=>k("0,250,154",t),springGreen:t=>k("0,255,127",t),mediumSeaGreen:t=>k("60,179,113",t),seaGreen:t=>k("46,139,87",t),forestGreen:t=>k("34,139,34",t),green:t=>k("0,128,0",t),darkGreen:t=>k("0,100,0",t),yellowGreen:t=>k("154,205,50",t),oliveDrab:t=>k("107,142,35",t),olive:t=>k("128,128,0",t),darkOliveGreen:t=>k("85,107,47",t),mediumAquamarine:t=>k("102,205,170",t),darkSeaGreen:t=>k("143,188,139",t),lightSeaGreen:t=>k("32,178,170",t),darkCyan:t=>k("0,139,139",t),teal:t=>k("0,128,128",t)},v=class{constructor(){this.themes={dark:y,light:E},this.colors=_}getTheme(t=0,e="dark"){return this.themes[e]&&this.themes[e][t]?this.themes[e][t]:{}}getColor(t,e=1){return u(this.colors[t])?this.colors[t](e):""}};class T{constructor({selectorCanvas:t,background:e,type:i,title:o={},theme:s={},data:r={},axisY:n={},axisX:l={},line:h={},cap:g={},grid:d={},legend:p={},blockInfo:u={},padding:F=10}){this.padding=a(F)?c(F):F,this.cap=g,this.legend=p,this.type=i||"line",this.grid=d,this.line=h,this.axisY=n,this.axisX=l,this.title=o,this.background=e,this.selectorCanvas=t,this.blockInfo=u,this.data=r,this.theme=s,this.hideGroups=[]}_setCanvas(){return new class{constructor(t,e,i={}){this.canvasElement=document.querySelector(t),this.background=e,this.ctx=this.canvasElement.getContext("2d"),this.theme=i}_setDefaultStyles(){const{offsetWidth:t,offsetHeight:e}=this.canvasElement,i={display:"block",boxSizing:"border-box"};this.canvasElement.width=t,this.canvasElement.height=e,this.canvasElement.setAttribute("style",Object.keys(i).map((t=>`${t}:${i[t]}`)).join(";"))}getSizes(){const{width:t,height:e}=this.canvasElement;return{width:t,height:e}}_setBackground(){const t=this.background||this.theme.background,{width:e,height:i}=this.getSizes();new r(0,0,t,this.ctx,e,i,0,i).draw()}init(){return this._setDefaultStyles(),this._setBackground(),this}}(this.selectorCanvas,this.background,this.theme.canvas).init()}_setChartTitle(t){const{width:e,height:i}=t.getSizes();return new g(this.padding,this.data,t.ctx,e,i,this.type,this.title,this.theme.title).drawTitle()}_setLegend(t,e){const{font:i,circle:o,gaps:s,maxCount:r}=this.legend,a=Boolean(Object.keys(this.legend).length),c=e.getGapsForLegend(this.axisY,e.titleData);return new class{constructor(t,e,i,o,s,r,n,a,l={},h=4,c={},g={}){this.hideGroups=a,this.showLegend=t,this.line=i,this.font=r,this.data=e,this.ctx=o,this.bounds=s,this.circle=n,this.maxCount=h>0?h:4,this.legendGaps=l,this.totalHeight=0,this.themeForText=c,this.themeForCircle=g,this.items=[]}getMaxPosYAtLegendItems(){const t=this.items.map((({y:t})=>t));return Math.max(...t)}_getSizeGroups(t){const{size:e,weight:i=400}=this.font;return t.map((t=>{const o=h(e,i,t.group,this.ctx);return Object.assign(Object.assign(Object.assign({},o),t),{x:null,y:null})}))}_getDistanceGroups(t){if(!t.length)return 0;const{group:e={},circle:i={}}=this.legendGaps,{radius:o}=this.circle;return t.reduce(((t,{width:s})=>t+(s+(e.right||0)+2*o+(i.right||0))),0)}_getTopDistanceGroups(t){if(!t.length)return 0;const{group:e={}}=this.legendGaps,i=this._getMaxGroupTextHeight(t);return(e.bottom||0)+i}_getMaxGroupTextHeight(t){const e=t.map((({height:t})=>t));return Math.max(...e)}_getColumns(){const t=[],e=Object.keys(this.data);for(let i=0;i<e.length;i+=this.maxCount){const o=e.map((t=>Object.assign(Object.assign({},this.data[t]),{group:t}))).slice(i,i+this.maxCount).map((({group:t,line:i={}})=>{const o=e.indexOf(t),s=D(o,this.themeForCircle.color);return{group:t,color:i.color||(this.line||{}).color||i.fill||(this.line||{}).fill||s}}));t.push(o)}return t}_drawText(t,e,i,o,s,r){const a=this.bounds,h=a.width/2,c=this._getDistanceGroups(o),{size:g,weight:d=400,color:p=this.themeForText.color}=this.font,u={size:g,color:p,str:l(g,d),text:t},F=o.filter(((t,e)=>e<s)),C={x:a.horizontal.start+(r.left||0)+h-c/2+this._getDistanceGroups(F),y:a.vertical.start+(r.top||0)+i};if(new n(u,this.ctx,C.x,C.y).draw(),this.hideGroups.includes(t)){const t=e+C.x,o=C.y-i/2;new x(C.x,o,p,this.ctx,[{x:t,y:o}],2).draw()}return C}_drawCircle(t,e,i,o){const{radius:s}=this.circle,{circle:r={}}=this.legendGaps,n={x:t-s-(r.right||0),y:e-Math.max(s,i/2)};new C(s,n.x,n.y,o,this.ctx,1,n.y-s,n.y+s).draw()}_getDistanceTopFromPrevColumns(t,e){return t.filter(((t,i)=>i<e)).reduce(((t,e)=>t+this._getTopDistanceGroups(this._getSizeGroups(e))),0)}draw(t){if(!this.showLegend)return this;const e=this._getColumns();return e.map(((i,o)=>{const s=this._getSizeGroups(i),r=this._getDistanceTopFromPrevColumns(e,o);s.map((({group:e,color:i,height:o,width:n},a)=>{const l=this._drawText(e,n,o,s,a,Object.assign(Object.assign({},t),{top:t.top+r}));this.items.push(Object.assign(Object.assign({group:e},l),{height:o,width:n,color:i})),this._drawCircle(l.x,l.y,o,i)})),this.totalHeight+=this._getTopDistanceGroups(s)})),this}}(a,this.data,this.line,t.ctx,e.getBounds(),i,o,this.hideGroups,s,r,this.theme.legend,this.theme.line).draw(c)}_setAxisYTitle(t,e){const{step:i,editValue:o,title:s,font:r,sort:n}=this.axisY,a=(this.theme.axis||{}).title,l=(this.theme.axis||{}).point;return new F(o,this.data,t.ctx,s,e.getBounds(),r,this.axisX.sort,a,l,n,i).drawTitle()}_setAxisXTitle(t,e){const{font:i,editName:o,sort:s,ignoreNames:r,title:n,rotate:a}=this.axisX,l=(this.theme.axis||{}).title,h=(this.theme.axis||{}).point,c=this.theme.line;return new B(t.ctx,this.data,this.line,n,e.getBounds(),i,o,s,a,l,h,r,c).drawTitle()}_setPoints(t,e,i,o){const s=t.drawPoints(o.getGapsForYPoints(t,e,o.titleData,Object.assign(Object.assign({},this.legend),i))),r=e.drawPoints(o.getGapsForXPoints(t,e));return{pointsY:s.points,pointsX:r.points}}_setGrid(t,e,i){const{line:o,format:s,background:r}=this.grid;return new class{constructor(t,e,i,o,s,r,n,a={},l={}){this.maxPointYWidth=i,this.names=e,this.ctx=t,this.pointsY=o.points,this.pointsX=s.points,this.showPointsX=s.font.showText,this.showPointsY=o.font.showText,this.line=a,this.format=n||"default",this.theme=l,this.background=r,this.distanceBetweenLineAndPoint=5}_getPointsOnScreen(t){return t.filter((({onScreen:t})=>t))}_drawBackground(){if(!this.background)return;const t=this._getPointsOnScreen(this.pointsY),e=this._getPointsOnScreen(this.pointsX),{x:i}=e[0],{y:o}=t[0],{x:s}=e[e.length-1],{y:r}=t[t.length-1];new m(i,o,this.background,this.ctx,[{x:s,y:o},{x:s,y:r},{x:i,y:r},{x:i,y:o}],o,r).draw()}_drawHorizontalLines(t){const{width:e,dotted:i,stretch:o}=this.line,s=this._getPointsOnScreen(this.pointsY),{x:r}=this.pointsX[0],{x:n}=this.pointsX[this.pointsX.length-1],a=o&&this.showPointsY;s.map((({y:o,x:s})=>{new x(a?s+this.maxPointYWidth+this.distanceBetweenLineAndPoint:r,o,t,this.ctx,[{x:n,y:o}],e,i).draw()}))}_drawVerticalLines(t){const{width:e,dotted:i,stretch:o}=this.line,s=this._getPointsOnScreen(this.pointsY),r=this._getPointsOnScreen(this.pointsX),{y:n}=s[0],{y:a}=r[r.length-1],{y:l}=s[s.length-1];this.names.map((s=>{const{x:h,height:c}=this.pointsX.find((t=>t.name===s)),g=Boolean(r.find((t=>t.name===s))),d=o&&g&&this.showPointsX;new x(h,n,t,this.ctx,[{x:h,y:d?a-(c+this.distanceBetweenLineAndPoint):l}],e,i).draw()}))}init(){if(!Object.keys(this.line).length)return;this._drawBackground();const t=this.line.color||this.theme.color;switch(this.format){case"horizontal":this._drawHorizontalLines(t);break;case"vertical":this._drawVerticalLines(t);break;default:this._drawVerticalLines(t),this._drawHorizontalLines(t)}return this}}(t.ctx,i.getAxesData(this.data).names,i.getMaxTextWidthAtYAxis(),i,e,r,s,o,this.theme.grid).init()}_windowResizeHandler(){this.update()}_windowResize(){window.addEventListener("resize",this._windowResizeHandler.bind(this))}_mousemoveByCanvasHandler(t,e,i,o,s,r){const n={x:t.offsetX,y:t.offsetY},{events:a={}}=this.blockInfo;if(n.y<=e&&n.y>=o){const t=i.map((t=>u(this.axisX.editName)?Object.assign(Object.assign({},t),{name:this.axisX.editName(t.name)}):t)).filter((({x:t,group:e})=>!this.hideGroups.includes(e)&&n.x>t-5&&n.x<t+5));if(t.length){this.update();const[{x:e}]=t,{title:i,groups:o,background:l,padding:h}=this.blockInfo,c=(this.theme.blockInfo||{}).window,g=this.theme.line,d=(this.theme.blockInfo||{}).title,p=(this.theme.blockInfo||{}).group;new A(this.axisY.editValue,this.axisX.editName,this.data,r,t,i,o,e,n.y,l,s.ctx,h,c,g,d,p).init(),u(a.onAimed)&&a.onAimed.call(Object.assign(Object.assign({},n),{activeElements:t}))}}}_mousemoveByCanvas(t,e,{pointsX:i,pointsY:o}){if(!Object.keys(this.blockInfo).length)return;const s=o.filter((({onScreen:t})=>t)),{y:r,height:n}=s[0],{y:a,height:l}=s[s.length-1],h=a-n/2,c=r-l/2;t.canvasElement.addEventListener("mousemove",(o=>this._mousemoveByCanvasHandler(o,h,i,c,t,e)))}_leavemouseFromCanvasAreaHandler(){document.documentElement.setAttribute("style","default"),this.update()}_leavemouseFromCanvasArea(t){t.canvasElement.addEventListener("mouseleave",this._leavemouseFromCanvasAreaHandler.bind(this))}_clickByCanvasAreaHandler(t,e){const{events:i={}}=this.legend,o=t.offsetX,s=t.offsetY,r=e.find((({x:t,y:e,width:i,height:r})=>o<=t+i&&o>=t&&s<=e&&s>=e-r));if(r){const{group:t}=r,o=this.hideGroups.indexOf(t);if(-1!==o?this.hideGroups.splice(o,1):this.hideGroups.push(t),u(i.onClick)){const t=e.filter((({group:t})=>this.hideGroups.includes(t))),o=e.filter((({group:t})=>!this.hideGroups.includes(t)));i.onClick.call({element:r,hiddenElements:t,elements:e,notHiddenElements:o})}this.update()}}_clickByCanvasArea(t,e){t.canvasElement.addEventListener("click",(t=>this._clickByCanvasAreaHandler(t,e)))}_drawChartByType(t,e,i){const{width:o,height:s}=i.getSizes();"line"===this.type&&new f(this.data,this.line,this.cap,t.points,e.points,i.ctx,o,s,null,null,this.hideGroups,this.axisY.sort,this.theme.line,this.theme.cap).draw()}update(){const t=this._setCanvas(),e=this._setChartTitle(t),i=this._setLegend(t,e),o=this._setAxisYTitle(t,e),s=this._setAxisXTitle(t,e);return this._setPoints(o,s,i,e),this._setGrid(t,s,o),this._drawChartByType(o,s,t),this}init(){const t=this._setCanvas(),e=this._setChartTitle(t),i=this._setLegend(t,e),o=this._setAxisYTitle(t,e),s=this._setAxisXTitle(t,e),r=this._setPoints(o,s,i,e);return this._mousemoveByCanvas(t,e.getBounds(),r),this._leavemouseFromCanvasArea(t),this._clickByCanvasArea(t,i.items),this._setGrid(t,s,o),this._drawChartByType(o,s,t),this._windowResize(),this}}return e})()));